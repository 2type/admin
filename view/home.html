[[extends "./layout/page.html"]]
[[block main()]]
<ta-page :header="header">
    <el-row :gutter="20">
        <el-col :span="12">
            <ta-box title="销售额">
                <!-- 使用 ref 配合渲染图表 -->
                <div ref="g2ChartNode" style="width:100%;height:300px" ></div>
            </ta-box>
        </el-col>
        <el-col :span="12">
            <ta-box title="推广统计">
                <!-- 使用 ref 配合渲染图表 -->
                <div ref="saleChartNode" style="height:300px" ></div>
            </ta-box>
        </el-col>
        <el-col :span="12">
            <ta-box title="Top5 客户">
                <el-table
                        :data="top5Client"
                        style="width: 100%">
                    <el-table-column
                            prop="order"
                            label="排名"
                            width="100">
                        <template slot-scope="scope">
                            {{scope.$index+1}}
                        </template>
                    </el-table-column>
                    <el-table-column
                            prop="name"
                            label="客户名"
                            width="180">
                        <template slot-scope="scope">
                            <el-image
                                    style="width: 30px; height: 30px;border-radius:50%;margin-bottom:-.4em;"
                                    :src="scope.row.logo"
                                    fit="fit"></el-image>
                            </div>
                            {{scope.row.name}}
                        </template>
                    </el-table-column>
                    <el-table-column
                            prop="sale"
                            label="销售额">
                    </el-table-column>
                </el-table>
            </ta-box>
        </el-col>
        <el-col :span="12">
            <ta-box title="Top5 员工">
                <el-table
                        :data="top5staff"
                        style="width: 100%">
                    <el-table-column
                            prop="order"
                            label="排名"
                            width="100">
                        <template slot-scope="scope">
                            {{scope.$index+1}}
                        </template>
                    </el-table-column>
                    <el-table-column
                            prop="name"
                            label="员工名"
                            width="180">
                        <template slot-scope="scope">
                            <el-image
                                    style="width: 30px; height: 30px;border-radius:50%;margin-bottom:-.4em;"
                                    :src="scope.row.avatar"
                                    fit="fit"></el-image>
                            </div>
                            {{scope.row.name}}
                        </template>
                    </el-table-column>
                    <el-table-column
                            prop="sale"
                            label="销售额">
                    </el-table-column>
                </el-table>
            </ta-box>
        </el-col>
    </el-row>
</ta-page>
[[end]]
[[block script()]]
<script>
    window.__RENDER_DATA = {
        top5Client: [
            {
                name: "可口可乐",
                logo: "https://picsum.photos/id/11/100/100",
                sale: 102314
            },
            {
                name: "百事可乐",
                logo: "https://picsum.photos/id/12/100/100",
                sale: 82414
            },
            {
                name: "百岁山",
                logo: "https://picsum.photos/id/13/100/100",
                sale: 72412
            },
            {
                name: "康师傅",
                logo: "https://picsum.photos/id/14/100/100",
                sale: 52351
            },
            {
                name: "李施德林",
                logo: "https://picsum.photos/id/15/100/100",
                sale: 3251
            }
        ],
        top5staff: [
            {
                avatar: "https://i.pravatar.cc/100?img=1",
                name: "法外狂徒张三",
                sale: 41512
            },
            {
                avatar: "https://i.pravatar.cc/100?img=2",
                name: "尼古拉斯赵四",
                sale: 40021
            },
            {
                avatar: "https://i.pravatar.cc/100?img=3",
                name: "大刀王五",
                sale: 3425
            },
            {
                avatar: "https://i.pravatar.cc/100?img=4",
                name: "独眼龙老六",
                sale: 31224
            },
            {
                avatar: "https://i.pravatar.cc/100?img=5",
                name: "小瘸子刘七",
                sale: 28983
            }
        ]
    }
</script>
<script type="module" >
    import { Chart } from 'https://cdn.skypack.dev/@antv/g2@v4.1.27'
    import * as echarts from "https://cdn.skypack.dev/echarts@5.2.1"
    const header = [
        {
            title: "首页",
            url: "",
        },
    ]
    const vm = new Vue({
        components: {},
        el: "#ta-app",
        data: function () {
            const out = {
                ...__RENDER_DATA,
                header: header,
            }
            return out
        },
        created() {
            const vm = this
            setTimeout(function (){
                // 使用前请确保 <script type="module" > 起始处引用了
                // import * as echarts from "https://cdn.skypack.dev/echarts@5.2.1"
                var chart = echarts.init(vm.$refs.saleChartNode);
                // 配置参考 https://echarts.apache.org/examples/zh/editor.html?c=line-stack
                const option = {tooltip: {trigger: 'axis'}, legend: {data: ['Email', 'Union Ads', 'Video Ads', 'Direct', 'Search Engine'] }, grid: {left: '3%', right: '4%', bottom: '3%', containLabel: true }, toolbox: {feature: {saveAsImage: {} } }, xAxis: {type: 'category', boundaryGap: false, data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'] }, yAxis: {type: 'value'}, series: [{name: 'Email', type: 'line', stack: 'Total', data: [120, 132, 101, 134, 90, 230, 210] }, {name: 'Union Ads', type: 'line', stack: 'Total', data: [220, 182, 191, 234, 290, 330, 310] }, {name: 'Video Ads', type: 'line', stack: 'Total', data: [150, 232, 201, 154, 190, 330, 410] }, {name: 'Direct', type: 'line', stack: 'Total', data: [320, 332, 301, 334, 390, 330, 320] }, {name: 'Search Engine', type: 'line', stack: 'Total', data: [820, 932, 901, 934, 1290, 1330, 1320] } ] };
                chart.setOption(option);
            }, 1000)
            // 一定要延迟渲染
            setTimeout(function (){
                // https://g2.antv.vision/zh/docs/manual/getting-started
                const data = [{"Data": "2010-01", "sales": 1998 }, {"Data": "2010-02", "sales": 1850 }, {"Data": "2010-03", "sales": 1720 }, {"Data": "2010-04", "sales": 1818 }, {"Data": "2010-05", "sales": 1920 }, {"Data": "2010-06", "sales": 1802 }, {"Data": "2010-07", "sales": 1945 }, {"Data": "2010-08", "sales": 1856 }, {"Data": "2010-09", "sales": 2107 }, {"Data": "2010-10", "sales": 2140 }, {"Data": "2010-11", "sales": 2311 }, {"Data": "2010-12", "sales": 1972 }, {"Data": "2011-01", "sales": 1760 }, {"Data": "2011-02", "sales": 1824 }, {"Data": "2011-03", "sales": 1801 }, {"Data": "2011-04", "sales": 2001 }, {"Data": "2011-05", "sales": 1640 }, {"Data": "2011-06", "sales": 1502 }, {"Data": "2011-07", "sales": 1621 }, {"Data": "2011-08", "sales": 1480 }, {"Data": "2011-09", "sales": 1549 }, {"Data": "2011-10", "sales": 1390 }, {"Data": "2011-11", "sales": 1325 }, {"Data": "2011-12", "sales": 1250 }, {"Data": "2012-01", "sales": 1394 }, {"Data": "2012-02", "sales": 1406 }, {"Data": "2012-03", "sales": 1578 }, {"Data": "2012-04", "sales": 1465 }, {"Data": "2012-05", "sales": 1689 }, {"Data": "2012-06", "sales": 1755 }, {"Data": "2012-07", "sales": 1495 }, {"Data": "2012-08", "sales": 1508 }, {"Data": "2012-09", "sales": 1433 }, {"Data": "2012-10", "sales": 1344 }, {"Data": "2012-11", "sales": 1201 }, {"Data": "2012-12", "sales": 1065 }, {"Data": "2013-01", "sales": 1255 }, {"Data": "2013-02", "sales": 1429 }, {"Data": "2013-03", "sales": 1398 }, {"Data": "2013-04", "sales": 1678 }, {"Data": "2013-05", "sales": 1524 }, {"Data": "2013-06", "sales": 1688 }, {"Data": "2013-07", "sales": 1500 }, {"Data": "2013-08", "sales": 1670 }, {"Data": "2013-09", "sales": 1734 }, {"Data": "2013-10", "sales": 1699 }, {"Data": "2013-11", "sales": 1508 }, {"Data": "2013-12", "sales": 1680 }, {"Data": "2014-01", "sales": 1750 }, {"Data": "2014-02", "sales": 1602 }, {"Data": "2014-03", "sales": 1834 }, {"Data": "2014-04", "sales": 1722 }, {"Data": "2014-05", "sales": 1430 }, {"Data": "2014-06", "sales": 1280 }, {"Data": "2014-07", "sales": 1367 }, {"Data": "2014-08", "sales": 1155 }, {"Data": "2014-09", "sales": 1289 }, {"Data": "2014-10", "sales": 1104 }, {"Data": "2014-11", "sales": 1246 }, {"Data": "2014-12", "sales": 1098 }, {"Data": "2015-01", "sales": 1189 }, {"Data": "2015-02", "sales": 1276 }, {"Data": "2015-03", "sales": 1033 }, {"Data": "2015-04", "sales": 956 }, {"Data": "2015-05", "sales": 845 }, {"Data": "2015-06", "sales": 1089 }, {"Data": "2015-07", "sales": 944 }, {"Data": "2015-08", "sales": 1043 }, {"Data": "2015-09", "sales": 893 }, {"Data": "2015-10", "sales": 840 }, {"Data": "2015-11", "sales": 934 }, {"Data": "2015-12", "sales": 810 }, {"Data": "2016-01", "sales": 782 }, {"Data": "2016-02", "sales": 1089 }, {"Data": "2016-03", "sales": 745 }, {"Data": "2016-04", "sales": 680 }, {"Data": "2016-05", "sales": 802 }, {"Data": "2016-06", "sales": 697 }, {"Data": "2016-07", "sales": 583 }, {"Data": "2016-08", "sales": 456 }, {"Data": "2016-09", "sales": 524 }, {"Data": "2016-10", "sales": 398 }, {"Data": "2016-11", "sales": 278 }, {"Data": "2016-12", "sales": 195 }, {"Data": "2017-01", "sales": 145 }, {"Data": "2017-02", "sales": 207 } ]
                const chart = new Chart({
                    container: vm.$refs.g2ChartNode,
                    autoFit: true,
                    height: 500,
                });
                chart.data(data);
                chart.scale('Data', {
                    range: [0, 1],
                    tickCount: 10,
                    type: 'timeCat'
                });
                chart.scale('sales', {
                    nice: true,
                });
                chart.axis('sales', {
                    label: {
                        formatter: text => {
                            return text.replace(/(\d)(?=(?:\d{3})+$)/g, '$1,');
                        }
                    }
                });
                chart.tooltip({
                    showCrosshairs: true,
                });

                chart.line().position('Data*sales');
                chart.area().position('Data*sales');
                chart.render();
            }, 1000)
        },
        methods: {
            ...TA.m,
        },
        computed:{

        }
    })
</script>
<style>

</style>
[[end]]